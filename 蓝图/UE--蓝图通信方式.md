# 反射

蓝图接口，和事件分发器，这两个功能，他们都离不开UE的反射，没有反射，这一切的一切都无法实现。他们都是基于这个地基之上的高楼。

反射是指在运行时获取一个对象的类型和属性信息，然后使用这些信息来执行操作。也就是，运行时类型信息可用。

# 直接通信
直接get获取通信对方，获取他的信息。通过get actor获取首个对象或多个对象数组，开销较大。
==什么时候用？==
	必须要引用某个独立的actor并联系的，比如关卡蓝图中调用摄像机切换镜头，获取某个npc坐标。
# 通过蓝图转换cast to
cast 的时候要特别注意的是object必须要正确，比如玩家蓝图的object需要get 玩家 pawn 或 character。

但是玩家好办，如果要获取某个npc或物品actor就不好获取了

可以通过get actor 获取类的Actor来实现（方法1），但是这种方式本身开销较大，不适合经常使用，除非你必须要获取某个没有直接交互的对象

所以我们可以通过其他方式，比如通过trace检测的方法。
返回命中结果里面的hit actor来获取我们需要的actor对象进而cast进行通信，因为游戏当中一般来说我们需要通信联系的对象都是要和我们直接互动的对象，所以使用类似这种检测的方法可以更加精准有效的获取对象。![[Pasted image 20231109194536.png]]
==什么时候用？==
需要获取玩家角色蓝图的时候

需要访问多个拥有相同父级蓝图的子蓝图的时候，比如敌人NPC

获取某个特殊蓝图或组件的时候，比如控件蓝图，动画蓝图

注意的是cast开销较大，不建议经常调用，所以可以在蓝图的事件开始运行时就cast转换并生成变量，后续访问直接使用该变量。
# 接口通信
使用接口，则需要actor在类设置里，添加需要的接口。
在UE5中将接口编译以及添加后会自动添加空实现，在事件图表左边栏内可以右键实现。
接口会有特殊标记
![[Pasted image 20231109195308.png]]
==什么时候用？==
访问多个不同类型蓝图通过同一个事件或函数执行不同结果的时候

比如不同物体都可以被玩家摧毁，但是有的破碎，有的直接消失，有的执行粒子效果，通过同一个接口触发
==注意==
**一个蓝图可以实现多个接口，也可以实现同一个接口的多个版本。**

**蓝图接口只能在蓝图之间传递数据和消息，不能直接调用函数或方法。**
# 事件分发器
使用事件分发器，可以绑定多个事件进行调用

我们可以建立事件分发器

拖入到场景中，对他进行绑定（事件），调用，解除绑定等操作

通过其他蓝图调用该分发器，进而激活绑定的事件

事件分发器就像是一个广播员，把消息发放出去，所有接收这个消息的都会执行相应的结果

在这种方法中，负责发送事件的Actor需要创建一个 事件分发器（Event Dispatcher）
![[Pasted image 20231109200440.png]]
所有监听该事件的Actor都会订阅该事件分发器。
![[Pasted image 20231109200457.png]]
此通信方法采用一对多关系，每当当前Actor触发事件分发器后，监听该Actor的其他Actor都会收到通知。

==什么时候用？==
多个场景监听相同一个事件，集体触发的时候

比如玩家打死一个boss，下个场景通道传送门开启，当前场景中的所有敌人都不再攻击玩家，玩家摆出胜利姿势，播放音效，特效等

==注意==
	事件必须在蓝图中定义。
	事件分发器可以在任何蓝图中调用，**可以是同一蓝图**中的其他事件，也可以是不同蓝图之间的事件。
	事件分发器可以通过调用**多个不同的事件**实现对同一消息的广播。
	事件分发器可以在蓝图之间传递消息和数据，也**可以调用其他蓝图中的函数或方法。**
# 蓝图接口与事件分发器的区别
1. 使用场景的区别

蓝图接口通常用于需要共享逻辑或数据的场景，例如不同角色的蓝图需要使用相同的功能或变量。而事件分发器通常用于消息广播的场景，例如游戏中需要触发某个事件时，可以通过事件分发器向所有需要接收该消息的蓝图发送消息。

2. 调用方式的不同

调用蓝图接口时，需要使用“实现接口”节点并将接口与实现进行绑定，然后才能调用接口方法。而调用事件分发器时，只需要在需要接收消息的蓝图中添加事件的响应节点，并将事件分发器与该节点进行绑定。

3. 数据传递的方式不同

蓝图接口和事件分发器都可以用于数据传递，但它们的传递方式不同。在使用蓝图接口时，数据是通过输入输出参数进行传递的，而在使用事件分发器时，数据是通过事件调用时所携带的参数进行传递的。

4. 适用范围的不同

蓝图接口和事件分发器都可以在同一蓝图中使用，但蓝图接口还可以在不同蓝图之间使用。而事件分发器只能在同一蓝图或基于同一蓝图的子蓝图之间使用。

5. 实现方式的不同

蓝图接口需要在蓝图中定义接口方法，并在实现接口的蓝图中添加相应的实现方法。而事件分发器只需要在蓝图中定义事件，并在需要接收该事件的蓝图中添加相应的响应节点即可。